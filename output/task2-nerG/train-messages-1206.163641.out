[12.06 16:37:11] ┇ INFO     ┇                                   chrisbase.data ┇ =========================================================================================================================================
[12.06 16:37:11] ┇ INFO     ┇                                   chrisbase.data ┇ [INIT] python /raid/chrisjihee/proj/DeepKNLP/DeepKNLP/arguments.py train
[12.06 16:37:11] ┇ INFO     ┇                                   chrisbase.data ┇ =========================================================================================================================================
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇ -----+-------------------------+----------------------------------------------------------------
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇    # | TrainingArguments       | value
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇ -----+-------------------------+----------------------------------------------------------------
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇    1 | env.hostname            | dgx-a100
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇    2 | env.hostaddr            | 129.254.23.12
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇    3 | env.global_rank         | 0
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇    4 | env.local_rank          | 0
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇    5 | env.node_rank           | 0
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇    6 | env.world_size          | 2
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇    7 | env.time_stamp          | 1206.163641
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇    8 | env.python_path         | /raid/chrisjihee/miniforge3/envs/DeepKNLP/bin/python
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇    9 | env.current_dir         | /raid/chrisjihee/proj/DeepKNLP
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   10 | env.current_file        | /raid/chrisjihee/proj/DeepKNLP/DeepKNLP/arguments.py
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   11 | env.command_args        | ['train']
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   12 | env.logging_home        | /raid/chrisjihee/proj/DeepKNLP/output/task2-nerG
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   13 | env.logging_file        | train-messages.out
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   14 | env.argument_file       | train-arguments.json
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   15 | env.random_seed         | 7
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   16 | env.max_workers         | 4
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   17 | env.debugging           | False
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   18 | env.date_format         | [%m.%d %H:%M:%S]
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   19 | env.message_level       | 20
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   20 | env.message_format      | %(asctime)s ┇ %(levelname)-8s ┇ %(name)48s ┇ %(message)s
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   21 | time.t1                 | 2024-12-06 16:37:11.497425
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   22 | time.t2                 | 2024-12-06 16:36:41.759280
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   23 | time.started            | [12.06 16:37:11]
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   24 | time.settled            |
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   25 | time.elapsed            |
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   26 | input.pretrained        | /raid/chrisjihee/proj/DeepKNLP/meta-llama/Llama-3.2-1B
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   27 | input.train_path        | /raid/chrisjihee/proj/DeepKNLP/data/gner/zero-shot-train.jsonl
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   28 | input.eval_path         |
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   29 | input.test_path         |
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   30 | input.max_train_samples | 256
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   31 | input.max_eval_samples  | -1
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   32 | input.max_test_samples  | -1
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   33 | input.num_prog_samples  | 5000
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   34 | input.max_source_length | 512
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   35 | input.max_target_length | 512
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   36 | input.use_cache_data    | False
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   37 | learn.output_home       | /raid/chrisjihee/proj/DeepKNLP/output
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   38 | learn.num_train_epochs  | 1
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   39 | learn.learning_rate     | 2e-05
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   40 | learn.weight_decay      | 0.0
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   41 | learn.accelerator       | gpu
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   42 | learn.precision         | bf16-mixed
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   43 | learn.gpu_index         | 4
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   44 | learn.num_device        | 2
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   45 | learn.grad_steps        | 8
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   46 | learn.train_batch       | 4
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   47 | learn.infer_batch       | 32
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   48 | learn.strategy          | deepspeed
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   49 | learn.ds_stage          | 2
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇   50 | learn.devices           | 2
[12.06 16:37:11] ┇ INFO     ┇                               DeepKNLP.arguments ┇ -----+-------------------------+----------------------------------------------------------------
[12.06 16:37:11] ┇ INFO     ┇                  lightning.fabric.utilities.seed ┇ [rank: 0] Seed set to 7
[12.06 16:37:11] ┇ INFO     ┇                  lightning.fabric.utilities.seed ┇ [rank: 1] Seed set to 7
[12.06 16:37:11] ┇ INFO     ┇                                         __main__ ┇ type(config)=<class 'transformers.models.llama.configuration_llama.LlamaConfig'> - True
[12.06 16:37:12] ┇ INFO     ┇                                         __main__ ┇ type(tokenizer)=<class 'transformers.tokenization_utils_fast.PreTrainedTokenizerFast'> - True, len(tokenizer)=128256
[12.06 16:37:13] ┇ INFO     ┇                                         __main__ ┇ type(model)=<class 'transformers.models.llama.modeling_llama.LlamaForCausalLM'> - True
[12.06 16:37:13] ┇ INFO     ┇                                         __main__ ┇ embedding_size=128256
[12.06 16:37:13] ┇ INFO     ┇                                         __main__ ┇ ----------------------------------------------------------------------------------------------------
[12.06 16:37:13] ┇ INFO     ┇                                         __main__ ┇ Use /raid/chrisjihee/proj/DeepKNLP/data/gner/zero-shot-train.jsonl as train dataset: 256 samples
[12.06 16:37:14] ┇ INFO     ┇                                         __main__ ┇ ----------------------------------------------------------------------------------------------------
[12.06 16:37:16] ┇ INFO     ┇                                         __main__ ┇ Preprocess train samples 100.00% 256/256... rate=182.71 Hz, eta=0:00:00, total=0:00:01
[12.06 16:37:18] ┇ INFO     ┇                                         __main__ ┇ ----------------------------------------------------------------------------------------------------
[12.06 16:37:18] ┇ INFO     ┇                                         __main__ ┇ type(optimizer)=<class 'torch.optim.adamw.AdamW'> - True
[12.06 16:37:37] ┇ INFO     ┇                                         __main__ ┇ type(optimizer)=<class 'lightning.fabric.wrappers.FabricDeepSpeedZeroOptimizer'> - True
[12.06 16:37:37] ┇ INFO     ┇                                         __main__ ┇ type(model)=<class 'lightning.fabric.wrappers._FabricModule'> - True
[12.06 16:37:37] ┇ INFO     ┇                                         __main__ ┇ ****************************************************************************************************
[12.06 16:37:37] ┇ INFO     ┇                                         __main__ ┇ ----------------------------------------------------------------------------------------------------
[12.06 16:37:37] ┇ INFO     ┇                                         __main__ ┇ Epoch: 0
[12.06 16:37:37] ┇ INFO     ┇                                         __main__ ┇ i=1
[12.06 16:37:40] ┇ INFO     ┇                                         __main__ ┇ loss=0.844304084777832
[12.06 16:37:40] ┇ INFO     ┇                                         __main__ ┇ i=2
[12.06 16:37:42] ┇ INFO     ┇                                         __main__ ┇ loss=0.9579153656959534
[12.06 16:37:42] ┇ INFO     ┇                                         __main__ ┇ i=3
[12.06 16:37:43] ┇ INFO     ┇                                         __main__ ┇ loss=1.1316871643066406
[12.06 16:37:43] ┇ INFO     ┇                                         __main__ ┇ i=4
[12.06 16:37:43] ┇ INFO     ┇                                         __main__ ┇ loss=1.0699800252914429
[12.06 16:37:43] ┇ INFO     ┇                                         __main__ ┇ i=5
[12.06 16:37:44] ┇ INFO     ┇                                         __main__ ┇ loss=0.8766821026802063
[12.06 16:37:44] ┇ INFO     ┇                                         __main__ ┇ i=6
[12.06 16:37:44] ┇ INFO     ┇                                         __main__ ┇ loss=1.4173146486282349
[12.06 16:37:44] ┇ INFO     ┇                                         __main__ ┇ i=7
[12.06 16:37:44] ┇ INFO     ┇                                         __main__ ┇ loss=0.7909431457519531
[12.06 16:37:44] ┇ INFO     ┇                                         __main__ ┇ i=8
[12.06 16:37:44] ┇ INFO     ┇                                         __main__ ┇ loss=1.030330777168274
[12.06 16:37:46] ┇ INFO     ┇                                         __main__ ┇ global_step=1
[12.06 16:37:46] ┇ INFO     ┇                                         __main__ ┇ i=9
[12.06 16:37:46] ┇ INFO     ┇                                         __main__ ┇ loss=0.8384069800376892
[12.06 16:37:46] ┇ INFO     ┇                                         __main__ ┇ i=10
[12.06 16:37:46] ┇ INFO     ┇                                         __main__ ┇ loss=0.7647799253463745
[12.06 16:37:46] ┇ INFO     ┇                                         __main__ ┇ i=11
[12.06 16:37:47] ┇ INFO     ┇                                         __main__ ┇ loss=0.6104441285133362
[12.06 16:37:47] ┇ INFO     ┇                                         __main__ ┇ i=12
[12.06 16:37:47] ┇ INFO     ┇                                         __main__ ┇ loss=0.8050214648246765
[12.06 16:37:47] ┇ INFO     ┇                                         __main__ ┇ i=13
[12.06 16:37:47] ┇ INFO     ┇                                         __main__ ┇ loss=0.7901914119720459
[12.06 16:37:47] ┇ INFO     ┇                                         __main__ ┇ i=14
[12.06 16:37:48] ┇ INFO     ┇                                         __main__ ┇ loss=0.805130660533905
[12.06 16:37:48] ┇ INFO     ┇                                         __main__ ┇ i=15
[12.06 16:37:48] ┇ INFO     ┇                                         __main__ ┇ loss=0.6603031754493713
[12.06 16:37:48] ┇ INFO     ┇                                         __main__ ┇ i=16
[12.06 16:37:48] ┇ INFO     ┇                                         __main__ ┇ loss=0.8123385906219482
[12.06 16:37:48] ┇ INFO     ┇                                         __main__ ┇ global_step=2
[12.06 16:37:48] ┇ INFO     ┇                                         __main__ ┇ i=17
[12.06 16:37:49] ┇ INFO     ┇                                         __main__ ┇ loss=0.9418085217475891
[12.06 16:37:49] ┇ INFO     ┇                                         __main__ ┇ i=18
[12.06 16:37:49] ┇ INFO     ┇                                         __main__ ┇ loss=0.9131541848182678
[12.06 16:37:49] ┇ INFO     ┇                                         __main__ ┇ i=19
[12.06 16:37:49] ┇ INFO     ┇                                         __main__ ┇ loss=1.0702346563339233
[12.06 16:37:49] ┇ INFO     ┇                                         __main__ ┇ i=20
[12.06 16:37:50] ┇ INFO     ┇                                         __main__ ┇ loss=0.8167746067047119
[12.06 16:37:50] ┇ INFO     ┇                                         __main__ ┇ i=21
[12.06 16:37:50] ┇ INFO     ┇                                         __main__ ┇ loss=0.9389302730560303
[12.06 16:37:50] ┇ INFO     ┇                                         __main__ ┇ i=22
[12.06 16:37:50] ┇ INFO     ┇                                         __main__ ┇ loss=0.8531432747840881
[12.06 16:37:50] ┇ INFO     ┇                                         __main__ ┇ i=23
[12.06 16:37:50] ┇ INFO     ┇                                         __main__ ┇ loss=0.7299769520759583
[12.06 16:37:50] ┇ INFO     ┇                                         __main__ ┇ i=24
[12.06 16:37:51] ┇ INFO     ┇                                         __main__ ┇ loss=1.0436208248138428
[12.06 16:37:51] ┇ INFO     ┇                                         __main__ ┇ global_step=3
[12.06 16:37:52] ┇ INFO     ┇                                         __main__ ┇ i=25
[12.06 16:37:52] ┇ INFO     ┇                                         __main__ ┇ loss=0.2579555809497833
[12.06 16:37:52] ┇ INFO     ┇                                         __main__ ┇ i=26
[12.06 16:37:52] ┇ INFO     ┇                                         __main__ ┇ loss=0.2647894620895386
[12.06 16:37:52] ┇ INFO     ┇                                         __main__ ┇ i=27
[12.06 16:37:53] ┇ INFO     ┇                                         __main__ ┇ loss=0.32699355483055115
[12.06 16:37:53] ┇ INFO     ┇                                         __main__ ┇ i=28
[12.06 16:37:53] ┇ INFO     ┇                                         __main__ ┇ loss=0.44979745149612427
[12.06 16:37:53] ┇ INFO     ┇                                         __main__ ┇ i=29
[12.06 16:37:53] ┇ INFO     ┇                                         __main__ ┇ loss=0.3495771288871765
[12.06 16:37:53] ┇ INFO     ┇                                         __main__ ┇ i=30
[12.06 16:37:54] ┇ INFO     ┇                                         __main__ ┇ loss=0.30562689900398254
[12.06 16:37:54] ┇ INFO     ┇                                         __main__ ┇ i=31
[12.06 16:37:54] ┇ INFO     ┇                                         __main__ ┇ loss=0.37283089756965637
[12.06 16:37:54] ┇ INFO     ┇                                         __main__ ┇ i=32
[12.06 16:37:54] ┇ INFO     ┇                                         __main__ ┇ loss=0.33090534806251526
[12.06 16:37:54] ┇ INFO     ┇                                         __main__ ┇ global_step=4
[12.06 16:37:54] ┇ INFO     ┇                                   chrisbase.data ┇ =========================================================================================================================================
[12.06 16:37:54] ┇ INFO     ┇                                   chrisbase.data ┇ [EXIT] python /raid/chrisjihee/proj/DeepKNLP/DeepKNLP/arguments.py train ($=00:00:43.153)
[12.06 16:37:54] ┇ INFO     ┇                                   chrisbase.data ┇ =========================================================================================================================================
