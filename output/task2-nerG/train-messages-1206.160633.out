[12.06 16:06:51] ┇ INFO     ┇                                   chrisbase.data ┇ =========================================================================================================================================
[12.06 16:06:51] ┇ INFO     ┇                                   chrisbase.data ┇ [INIT] python /raid/chrisjihee/proj/DeepKNLP/DeepKNLP/arguments.py train
[12.06 16:06:51] ┇ INFO     ┇                                   chrisbase.data ┇ =========================================================================================================================================
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇ -----+---------------------------+----------------------------------------------------------------
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇    # | NewTrainerArguments       | value
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇ -----+---------------------------+----------------------------------------------------------------
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇    1 | env.hostname              | dgx-a100
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇    2 | env.hostaddr              | 129.254.23.12
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇    3 | env.global_rank           | 0
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇    4 | env.local_rank            | 0
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇    5 | env.node_rank             | 0
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇    6 | env.world_size            | 2
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇    7 | env.time_stamp            | 1206.160633
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇    8 | env.python_path           | /raid/chrisjihee/miniforge3/envs/DeepKNLP/bin/python
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇    9 | env.current_dir           | /raid/chrisjihee/proj/DeepKNLP
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   10 | env.current_file          | /raid/chrisjihee/proj/DeepKNLP/DeepKNLP/arguments.py
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   11 | env.command_args          | ['train']
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   12 | env.logging_home          | /raid/chrisjihee/proj/DeepKNLP/output/task2-nerG
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   13 | env.logging_file          | train-messages.out
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   14 | env.argument_file         | train-arguments.json
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   15 | env.random_seed           | 7
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   16 | env.max_workers           | 4
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   17 | env.debugging             | False
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   18 | env.date_format           | [%m.%d %H:%M:%S]
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   19 | env.message_level         | 20
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   20 | env.message_format        | %(asctime)s ┇ %(levelname)-8s ┇ %(name)48s ┇ %(message)s
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   21 | time.t1                   | 2024-12-06 16:06:51.875043
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   22 | time.t2                   | 2024-12-06 16:06:33.124479
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   23 | time.started              | [12.06 16:06:51]
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   24 | time.settled              |
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   25 | time.elapsed              |
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   26 | input.output_home         | /raid/chrisjihee/proj/DeepKNLP/output
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   27 | input.pretrained          | /raid/chrisjihee/proj/DeepKNLP/meta-llama/Llama-3.2-1B
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   28 | input.train_path          | /raid/chrisjihee/proj/DeepKNLP/data/gner/zero-shot-train.jsonl
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   29 | input.eval_path           |
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   30 | input.test_path           |
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   31 | input.max_train_samples   | 256
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   32 | input.max_eval_samples    | -1
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   33 | input.max_test_samples    | -1
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   34 | input.num_prog_samples    | 5000
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   35 | input.max_source_length   | 512
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   36 | input.max_target_length   | 512
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   37 | input.use_cache_data      | False
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   38 | hardware.gpu_index        | 4
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   39 | hardware.num_device       | 2
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   40 | hardware.grad_steps       | 8
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   41 | hardware.train_batch      | 4
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   42 | hardware.infer_batch      | 32
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   43 | hardware.accelerator      | gpu
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   44 | hardware.precision        | bf16-mixed
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   45 | hardware.strategy         | deepspeed
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   46 | hardware.ds_stage         | 2
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   47 | hardware.devices          | 2
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   48 | learning.weight_decay     | 0.0
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   49 | learning.learning_rate    | 2e-05
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇   50 | learning.num_train_epochs | 1.0
[12.06 16:06:51] ┇ INFO     ┇                               DeepKNLP.arguments ┇ -----+---------------------------+----------------------------------------------------------------
[12.06 16:06:51] ┇ INFO     ┇                  lightning.fabric.utilities.seed ┇ [rank: 0] Seed set to 7
[12.06 16:06:51] ┇ INFO     ┇                  lightning.fabric.utilities.seed ┇ [rank: 1] Seed set to 7
[12.06 16:06:52] ┇ INFO     ┇                                         __main__ ┇ type(config)=<class 'transformers.models.llama.configuration_llama.LlamaConfig'> - True
[12.06 16:06:52] ┇ INFO     ┇                                         __main__ ┇ type(tokenizer)=<class 'transformers.tokenization_utils_fast.PreTrainedTokenizerFast'> - True, len(tokenizer)=128256
[12.06 16:06:53] ┇ INFO     ┇                                         __main__ ┇ type(model)=<class 'transformers.models.llama.modeling_llama.LlamaForCausalLM'> - True
[12.06 16:06:53] ┇ INFO     ┇                                         __main__ ┇ embedding_size=128256
[12.06 16:06:53] ┇ INFO     ┇                                         __main__ ┇ ----------------------------------------------------------------------------------------------------
[12.06 16:06:54] ┇ INFO     ┇                                         __main__ ┇ Use /raid/chrisjihee/proj/DeepKNLP/data/gner/zero-shot-train.jsonl as train dataset: 256 samples
[12.06 16:06:54] ┇ INFO     ┇                                         __main__ ┇ ----------------------------------------------------------------------------------------------------
[12.06 16:06:56] ┇ INFO     ┇                                         __main__ ┇ Preprocess train samples 100.00% 256/256... rate=177.73 Hz, eta=0:00:00, total=0:00:01
[12.06 16:06:59] ┇ INFO     ┇                                         __main__ ┇ ----------------------------------------------------------------------------------------------------
[12.06 16:06:59] ┇ INFO     ┇                                         __main__ ┇ type(optimizer)=<class 'torch.optim.adamw.AdamW'> - True
[12.06 16:07:17] ┇ INFO     ┇                                         __main__ ┇ type(optimizer)=<class 'lightning.fabric.wrappers.FabricDeepSpeedZeroOptimizer'> - True
[12.06 16:07:17] ┇ INFO     ┇                                         __main__ ┇ type(model)=<class 'lightning.fabric.wrappers._FabricModule'> - True
[12.06 16:07:17] ┇ INFO     ┇                                         __main__ ┇ ****************************************************************************************************
[12.06 16:07:17] ┇ INFO     ┇                                         __main__ ┇ ----------------------------------------------------------------------------------------------------
[12.06 16:07:17] ┇ INFO     ┇                                         __main__ ┇ Epoch: 0
[12.06 16:07:17] ┇ INFO     ┇                                         __main__ ┇ i=1
[12.06 16:07:20] ┇ INFO     ┇                                         __main__ ┇ loss=0.844304084777832
[12.06 16:07:20] ┇ INFO     ┇                                         __main__ ┇ i=2
[12.06 16:07:20] ┇ INFO     ┇                                         __main__ ┇ loss=0.9579153656959534
[12.06 16:07:20] ┇ INFO     ┇                                         __main__ ┇ i=3
[12.06 16:07:20] ┇ INFO     ┇                                         __main__ ┇ loss=1.1316871643066406
[12.06 16:07:20] ┇ INFO     ┇                                         __main__ ┇ i=4
[12.06 16:07:21] ┇ INFO     ┇                                         __main__ ┇ loss=1.0699800252914429
[12.06 16:07:21] ┇ INFO     ┇                                         __main__ ┇ i=5
[12.06 16:07:22] ┇ INFO     ┇                                         __main__ ┇ loss=0.8766821026802063
[12.06 16:07:22] ┇ INFO     ┇                                         __main__ ┇ i=6
[12.06 16:07:23] ┇ INFO     ┇                                         __main__ ┇ loss=1.4173146486282349
[12.06 16:07:23] ┇ INFO     ┇                                         __main__ ┇ i=7
[12.06 16:07:23] ┇ INFO     ┇                                         __main__ ┇ loss=0.7909431457519531
[12.06 16:07:23] ┇ INFO     ┇                                         __main__ ┇ i=8
[12.06 16:07:23] ┇ INFO     ┇                                         __main__ ┇ loss=1.030330777168274
[12.06 16:07:23] ┇ INFO     ┇                                         __main__ ┇ global_step=1
[12.06 16:07:23] ┇ INFO     ┇                                         __main__ ┇ i=9
[12.06 16:07:23] ┇ INFO     ┇                                         __main__ ┇ loss=0.8418944478034973
[12.06 16:07:23] ┇ INFO     ┇                                         __main__ ┇ i=10
[12.06 16:07:23] ┇ INFO     ┇                                         __main__ ┇ loss=0.7629424333572388
[12.06 16:07:23] ┇ INFO     ┇                                         __main__ ┇ i=11
[12.06 16:07:24] ┇ INFO     ┇                                         __main__ ┇ loss=0.6119741201400757
[12.06 16:07:24] ┇ INFO     ┇                                         __main__ ┇ i=12
[12.06 16:07:24] ┇ INFO     ┇                                         __main__ ┇ loss=0.8044254183769226
[12.06 16:07:24] ┇ INFO     ┇                                         __main__ ┇ i=13
[12.06 16:07:24] ┇ INFO     ┇                                         __main__ ┇ loss=0.7918433547019958
[12.06 16:07:24] ┇ INFO     ┇                                         __main__ ┇ i=14
[12.06 16:07:24] ┇ INFO     ┇                                         __main__ ┇ loss=0.8032152056694031
[12.06 16:07:24] ┇ INFO     ┇                                         __main__ ┇ i=15
[12.06 16:07:24] ┇ INFO     ┇                                         __main__ ┇ loss=0.6601208448410034
[12.06 16:07:24] ┇ INFO     ┇                                         __main__ ┇ i=16
[12.06 16:07:24] ┇ INFO     ┇                                         __main__ ┇ loss=0.8112481236457825
[12.06 16:07:24] ┇ INFO     ┇                                         __main__ ┇ global_step=2
[12.06 16:07:24] ┇ INFO     ┇                                         __main__ ┇ i=17
[12.06 16:07:24] ┇ INFO     ┇                                         __main__ ┇ loss=0.9427619576454163
[12.06 16:07:24] ┇ INFO     ┇                                         __main__ ┇ i=18
[12.06 16:07:25] ┇ INFO     ┇                                         __main__ ┇ loss=0.9080758690834045
[12.06 16:07:25] ┇ INFO     ┇                                         __main__ ┇ i=19
[12.06 16:07:25] ┇ INFO     ┇                                         __main__ ┇ loss=1.0650849342346191
[12.06 16:07:25] ┇ INFO     ┇                                         __main__ ┇ i=20
[12.06 16:07:25] ┇ INFO     ┇                                         __main__ ┇ loss=0.8151269555091858
[12.06 16:07:25] ┇ INFO     ┇                                         __main__ ┇ i=21
[12.06 16:07:25] ┇ INFO     ┇                                         __main__ ┇ loss=0.9363160133361816
[12.06 16:07:25] ┇ INFO     ┇                                         __main__ ┇ i=22
[12.06 16:07:25] ┇ INFO     ┇                                         __main__ ┇ loss=0.8453896045684814
[12.06 16:07:25] ┇ INFO     ┇                                         __main__ ┇ i=23
[12.06 16:07:25] ┇ INFO     ┇                                         __main__ ┇ loss=0.72978675365448
[12.06 16:07:25] ┇ INFO     ┇                                         __main__ ┇ i=24
[12.06 16:07:25] ┇ INFO     ┇                                         __main__ ┇ loss=1.0406849384307861
[12.06 16:07:25] ┇ INFO     ┇                                         __main__ ┇ global_step=3
[12.06 16:07:26] ┇ INFO     ┇                                         __main__ ┇ i=25
[12.06 16:07:26] ┇ INFO     ┇                                         __main__ ┇ loss=0.2591210603713989
[12.06 16:07:26] ┇ INFO     ┇                                         __main__ ┇ i=26
[12.06 16:07:27] ┇ INFO     ┇                                         __main__ ┇ loss=0.2661500573158264
[12.06 16:07:27] ┇ INFO     ┇                                         __main__ ┇ i=27
[12.06 16:07:27] ┇ INFO     ┇                                         __main__ ┇ loss=0.32563862204551697
[12.06 16:07:27] ┇ INFO     ┇                                         __main__ ┇ i=28
[12.06 16:07:27] ┇ INFO     ┇                                         __main__ ┇ loss=0.448058545589447
[12.06 16:07:27] ┇ INFO     ┇                                         __main__ ┇ i=29
[12.06 16:07:27] ┇ INFO     ┇                                         __main__ ┇ loss=0.3517187833786011
[12.06 16:07:27] ┇ INFO     ┇                                         __main__ ┇ i=30
[12.06 16:07:27] ┇ INFO     ┇                                         __main__ ┇ loss=0.30831584334373474
[12.06 16:07:27] ┇ INFO     ┇                                         __main__ ┇ i=31
[12.06 16:07:27] ┇ INFO     ┇                                         __main__ ┇ loss=0.3716471791267395
[12.06 16:07:27] ┇ INFO     ┇                                         __main__ ┇ i=32
[12.06 16:07:27] ┇ INFO     ┇                                         __main__ ┇ loss=0.332092821598053
[12.06 16:07:27] ┇ INFO     ┇                                         __main__ ┇ global_step=4
[12.06 16:07:28] ┇ INFO     ┇                                   chrisbase.data ┇ =========================================================================================================================================
[12.06 16:07:28] ┇ INFO     ┇                                   chrisbase.data ┇ [EXIT] python /raid/chrisjihee/proj/DeepKNLP/DeepKNLP/arguments.py train ($=00:00:35.936)
[12.06 16:07:28] ┇ INFO     ┇                                   chrisbase.data ┇ =========================================================================================================================================
