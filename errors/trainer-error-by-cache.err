To run a command as administrator (user "root"), use "sudo <command>".
See "man sudo_root" for details.

(DeepKNLP) chrisjihee@ptlm3:~/proj/DeepKNLP$ /bin/bash /home/chrisjihee/proj/DeepKNLP/task2-nerG-trainer.sh
+ CUDA_VISIBLE_DEVICES=0,1,2,3
++ shuf -i25000-30000 -n1
+ port=25598
+ python -m deepspeed.launcher.runner --include=localhost:0,1,2,3 --master_port 25598 task2-nerG-trainer.py data/gner/each/crossner_ai-train.jsonl --eval_file data/gner/each-sampled/crossner_ai-dev=100.jsonl --pretrained google/flan-t5-large --run_version FLAN-T5-Large --per_device_train_batch_size 1 --trainer_deepspeed configs/deepspeed/ds2_llama.json
[2025-02-03 18:15:16,473] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:15:19,448] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-02-03 18:15:19,448] [INFO] [runner.py:607:main] cmd = /home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgM119 --master_addr=127.0.0.1 --master_port=25598 --enable_each_rank_log=None task2-nerG-trainer.py data/gner/each/crossner_ai-train.jsonl --eval_file data/gner/each-sampled/crossner_ai-dev=100.jsonl --pretrained google/flan-t5-large --run_version FLAN-T5-Large --per_device_train_batch_size 1 --trainer_deepspeed configs/deepspeed/ds2_llama.json
[2025-02-03 18:15:21,350] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:15:24,277] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3]}
[2025-02-03 18:15:24,277] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=4, node_rank=0
[2025-02-03 18:15:24,277] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2025-02-03 18:15:24,277] [INFO] [launch.py:164:main] dist_world_size=4
[2025-02-03 18:15:24,278] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
[2025-02-03 18:15:24,278] [INFO] [launch.py:256:main] process 419139 spawned with command: ['/home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python', '-u', 'task2-nerG-trainer.py', '--local_rank=0', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'google/flan-t5-large', '--run_version', 'FLAN-T5-Large', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json']
[2025-02-03 18:15:24,279] [INFO] [launch.py:256:main] process 419140 spawned with command: ['/home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python', '-u', 'task2-nerG-trainer.py', '--local_rank=1', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'google/flan-t5-large', '--run_version', 'FLAN-T5-Large', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json']
[2025-02-03 18:15:24,280] [INFO] [launch.py:256:main] process 419141 spawned with command: ['/home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python', '-u', 'task2-nerG-trainer.py', '--local_rank=2', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'google/flan-t5-large', '--run_version', 'FLAN-T5-Large', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json']
[2025-02-03 18:15:24,280] [INFO] [launch.py:256:main] process 419142 spawned with command: ['/home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python', '-u', 'task2-nerG-trainer.py', '--local_rank=3', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'google/flan-t5-large', '--run_version', 'FLAN-T5-Large', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json']
[2025-02-03 18:15:32,658] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:15:32,663] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:15:32,666] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:15:32,667] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:15:33,378] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-03 18:15:33,381] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-03 18:15:33,384] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-03 18:15:33,408] [INFO] [comm.py:652:init_distributed] cdb=None
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ [INIT] python task2-nerG-trainer.py --local_rank=0 data/gner/each/crossner_ai-train.jsonl --eval_file data/gner/each-sampled/crossner_ai-dev=100.jsonl --pretrained google/flan-t5-large --run_version FLAN-T5-Large --per_device_train_batch_size 1 --trainer_deepspeed configs/deepspeed/ds2_llama.json
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇   #     TrainingArgumentsForAccelerator                 value
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇   1     env.hostname                                    ptlm3
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇   2     env.hostaddr                                    129.254.121.74
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇   3     env.global_rank                                 -1
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇   4     env.local_rank                                  0
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇   5     env.node_rank                                   -1
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇   6     env.world_size                                  4
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇   7     env.time_stamp                                  0203-181529
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇   8     env.python_path                                 /home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇   9     env.current_dir                                 /home/chrisjihee/proj/DeepKNLP
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  10     env.current_file                                task2-nerG-trainer.py
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  11     env.command_args                                ['--local_rank=0', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'google/flan-t5-large', '--run_version', 'FLAN-T5-Large', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json']
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  12     env.output_home                                 output
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  13     env.output_name                                 GNER
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  14     env.run_version                                 FLAN-T5-Large
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  15     env.output_file                                 train-metrics-0203-181529.csv
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  16     env.logging_file                                train-loggings-0203-181529.out
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  17     env.logging_level                               30
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  18     env.logging_format                              %(asctime)s ┇ %(levelname)-7s ┇ %(name)24s ┇ %(message)s
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  19     env.datetime_format                             [%m.%d %H:%M:%S]
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  20     env.argument_file                               train-arguments-0203-181529.json
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  21     env.random_seed                                 7
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  22     env.max_workers                                 4
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  23     env.debugging                                   False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  24     env.output_dir                                  output/GNER/FLAN-T5-Large
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  25     time.t1                                         2025-02-03 18:15:34.384846
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  26     time.t2                                         2025-02-03 18:15:28.075617
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  27     time.started                                    [02.03 18:15:34]
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  28     time.settled
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  29     time.elapsed
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  30     data.train_file                                 data/gner/each/crossner_ai-train.jsonl
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  31     data.study_file
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  32     data.eval_file                                  data/gner/each-sampled/crossner_ai-dev=100.jsonl
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  33     data.pred_file
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  34     data.pretrained                                 google/flan-t5-large
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  35     data.max_train_samples                          -1
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  36     data.max_study_samples                          -1
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  37     data.max_eval_samples                           -1
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  38     data.max_pred_samples                           -1
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  39     data.use_cache_data                             True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  40     data.progress_seconds                           10.0
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  41     data.max_source_length                          640
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  42     data.max_target_length                          640
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  43     data.write_predictions                          False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  44     data.ignore_pad_token_for_loss                  True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  45     train._n_gpu                                    1
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  46     train.accelerator_config                        {'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'non_blocking': False, 'gradient_accumulation_kwargs': None, 'use_configured_state': False}
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  47     train.adafactor                                 False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  48     train.adam_beta1                                0.9
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  49     train.adam_beta2                                0.999
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  50     train.adam_epsilon                              1e-08
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  51     train.auto_find_batch_size                      False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  52     train.average_tokens_across_devices             False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  53     train.batch_eval_metrics                        False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  54     train.bf16                                      True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  55     train.bf16_full_eval                            True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  56     train.data_seed
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  57     train.dataloader_drop_last                      False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  58     train.dataloader_num_workers                    0
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  59     train.dataloader_persistent_workers             False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  60     train.dataloader_pin_memory                     True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  61     train.dataloader_prefetch_factor
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  62     train.ddp_backend
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  63     train.ddp_broadcast_buffers
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  64     train.ddp_bucket_cap_mb
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  65     train.ddp_find_unused_parameters
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  66     train.ddp_timeout                               1800
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  67     train.debug                                     []
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  68     train.deepspeed                                 configs/deepspeed/ds2_llama.json
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  69     train.disable_tqdm                              True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  70     train.dispatch_batches
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  71     train.do_eval                                   True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  72     train.do_predict                                False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  73     train.do_train                                  True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  74     train.eval_accumulation_steps                   1
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  75     train.eval_delay                                1.0
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  76     train.eval_do_concat_batches                    True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  77     train.eval_epochs                               -1.0
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  78     train.eval_on_start                             False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  79     train.eval_steps                                9223372036854775807
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  80     train.eval_strategy                             IntervalStrategy.NO
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  81     train.eval_use_gather_object                    False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  82     train.evaluation_strategy
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  83     train.fp16                                      False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  84     train.fp16_backend                              auto
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  85     train.fp16_full_eval                            False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  86     train.fp16_opt_level                            O1
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  87     train.fsdp                                      []
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  88     train.fsdp_config                               {'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False}
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  89     train.fsdp_min_num_params                       0
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  90     train.fsdp_transformer_layer_cls_to_wrap
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  91     train.full_determinism                          False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  92     train.generation_config
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  93     train.generation_max_length                     640
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  94     train.generation_num_beams
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  95     train.gradient_accumulation_steps               1
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  96     train.gradient_checkpointing                    True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  97     train.gradient_checkpointing_kwargs
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  98     train.greater_is_better
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇  99     train.group_by_length                           False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 100     train.half_precision_backend                    auto
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 101     train.hub_always_push                           False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 102     train.hub_model_id
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 103     train.hub_private_repo
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 104     train.hub_strategy                              HubStrategy.EVERY_SAVE
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 105     train.hub_token
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 106     train.ignore_data_skip                          False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 107     train.include_for_metrics                       []
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 108     train.include_inputs_for_metrics                False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 109     train.include_num_input_tokens_seen             False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 110     train.include_tokens_per_second                 False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 111     train.jit_mode_eval                             False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 112     train.label_names
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 113     train.label_smoothing_factor                    0.0
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 114     train.learning_rate                             2e-05
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 115     train.length_column_name                        length
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 116     train.load_best_model_at_end                    False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 117     train.local_rank                                0
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 118     train.log_level                                 warning
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 119     train.log_level_replica                         error
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 120     train.log_on_each_node                          True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 121     train.logging_dir                               output/GNER/FLAN-T5-Large/runs/Feb03_18-15-32_ptlm3
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 122     train.logging_epochs                            -1.0
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 123     train.logging_first_step                        False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 124     train.logging_nan_inf_filter                    True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 125     train.logging_steps                             1
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 126     train.logging_strategy                          IntervalStrategy.STEPS
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 127     train.lr_scheduler_kwargs                       {}
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 128     train.lr_scheduler_type                         SchedulerType.COSINE
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 129     train.max_grad_norm                             1.0
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 130     train.max_steps                                 -1
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 131     train.metric_for_best_model
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 132     train.mp_parameters
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 133     train.neftune_noise_alpha
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 134     train.no_cuda                                   False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 135     train.num_train_epochs                          1.0
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 136     train.optim                                     OptimizerNames.ADAMW_TORCH
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 137     train.optim_args
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 138     train.optim_target_modules
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 139     train.output_dir                                output/GNER/FLAN-T5-Large
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 140     train.overwrite_output_dir                      True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 141     train.past_index                                -1
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 142     train.per_device_eval_batch_size                25
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 143     train.per_device_train_batch_size               1
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 144     train.per_gpu_eval_batch_size
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 145     train.per_gpu_train_batch_size
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 146     train.predict_with_generate                     True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 147     train.prediction_loss_only                      False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 148     train.push_to_hub                               False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 149     train.push_to_hub_model_id
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 150     train.push_to_hub_organization
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 151     train.push_to_hub_token
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 152     train.ray_scope                                 last
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 153     train.remove_unused_columns                     False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 154     train.report_to                                 []
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 155     train.restore_callback_states_from_checkpoint   False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 156     train.resume_from_checkpoint
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 157     train.run_name                                  output/GNER/FLAN-T5-Large
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 158     train.save_epochs                               -1.0
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 159     train.save_on_each_node                         False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 160     train.save_only_model                           False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 161     train.save_safetensors                          True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 162     train.save_steps                                9223372036854775807
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 163     train.save_strategy                             SaveStrategy.NO
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 164     train.save_total_limit
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 165     train.seed                                      7
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 166     train.skip_memory_metrics                       True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 167     train.sortish_sampler                           False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 168     train.split_batches
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 169     train.tf32                                      True
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 170     train.torch_compile                             False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 171     train.torch_compile_backend
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 172     train.torch_compile_mode
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 173     train.torch_empty_cache_steps
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 174     train.torchdynamo
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 175     train.tpu_metrics_debug                         False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 176     train.tpu_num_cores
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 177     train.use_cpu                                   False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 178     train.use_ipex                                  False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 179     train.use_legacy_prediction_loop                False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 180     train.use_liger_kernel                          False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 181     train.use_mps_device                            False
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 182     train.warmup_ratio                              0.04
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 183     train.warmup_steps                              0
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ 184     train.weight_decay                              0.0
[02.03 18:15:34] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.03 18:15:36] ┇ INFO    ┇                 DeepKNLP ┇ type(model)=<class 'transformers.models.t5.modeling_t5.T5ForConditionalGeneration'>
[02.03 18:15:36] ┇ INFO    ┇                 DeepKNLP ┇ model.generation_config.pad_token_id=0
/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/tokenization_utils_base.py:3962: UserWarning: `as_target_tokenizer` is deprecated and will be removed in v5 of Transformers. You can tokenize your labels by using the argument `text_target` of the regular `__call__` method (either in the same call as your input texts if you use the same keyword arguments, or in a separate call.
  warnings.warn(
/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/tokenization_utils_base.py:3962: UserWarning: `as_target_tokenizer` is deprecated and will be removed in v5 of Transformers. You can tokenize your labels by using the argument `text_target` of the regular `__call__` method (either in the same call as your input texts if you use the same keyword arguments, or in a separate call.
  warnings.warn(
/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/tokenization_utils_base.py:3962: UserWarning: `as_target_tokenizer` is deprecated and will be removed in v5 of Transformers. You can tokenize your labels by using the argument `text_target` of the regular `__call__` method (either in the same call as your input texts if you use the same keyword arguments, or in a separate call.
  warnings.warn(
/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/tokenization_utils_base.py:3962: UserWarning: `as_target_tokenizer` is deprecated and will be removed in v5 of Transformers. You can tokenize your labels by using the argument `text_target` of the regular `__call__` method (either in the same call as your input texts if you use the same keyword arguments, or in a separate call.
  warnings.warn(
/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/tokenization_utils_base.py:3962: UserWarning: `as_target_tokenizer` is deprecated and will be removed in v5 of Transformers. You can tokenize your labels by using the argument `text_target` of the regular `__call__` method (either in the same call as your input texts if you use the same keyword arguments, or in a separate call.
  warnings.warn(
/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/tokenization_utils_base.py:3962: UserWarning: `as_target_tokenizer` is deprecated and will be removed in v5 of Transformers. You can tokenize your labels by using the argument `text_target` of the regular `__call__` method (either in the same call as your input texts if you use the same keyword arguments, or in a separate call.
  warnings.warn(
/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/tokenization_utils_base.py:3962: UserWarning: `as_target_tokenizer` is deprecated and will be removed in v5 of Transformers. You can tokenize your labels by using the argument `text_target` of the regular `__call__` method (either in the same call as your input texts if you use the same keyword arguments, or in a separate call.
  warnings.warn(
/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/tokenization_utils_base.py:3962: UserWarning: `as_target_tokenizer` is deprecated and will be removed in v5 of Transformers. You can tokenize your labels by using the argument `text_target` of the regular `__call__` method (either in the same call as your input texts if you use the same keyword arguments, or in a separate call.
  warnings.warn(
[02.03 18:15:36] ┇ INFO    ┇                 DeepKNLP ┇ Loaded raw train_dataset (#=100): data/gner/each/crossner_ai-train.jsonl
[02.03 18:15:36] ┇ INFO    ┇                 DeepKNLP ┇ Completed preprocessing for train_dataset at [02.03 18:15:36]
/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/tokenization_utils_base.py:3962: UserWarning: `as_target_tokenizer` is deprecated and will be removed in v5 of Transformers. You can tokenize your labels by using the argument `text_target` of the regular `__call__` method (either in the same call as your input texts if you use the same keyword arguments, or in a separate call.
  warnings.warn(
/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/tokenization_utils_base.py:3962: UserWarning: `as_target_tokenizer` is deprecated and will be removed in v5 of Transformers. You can tokenize your labels by using the argument `text_target` of the regular `__call__` method (either in the same call as your input texts if you use the same keyword arguments, or in a separate call.
  warnings.warn(
/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/tokenization_utils_base.py:3962: UserWarning: `as_target_tokenizer` is deprecated and will be removed in v5 of Transformers. You can tokenize your labels by using the argument `text_target` of the regular `__call__` method (either in the same call as your input texts if you use the same keyword arguments, or in a separate call.
  warnings.warn(
/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/tokenization_utils_base.py:3962: UserWarning: `as_target_tokenizer` is deprecated and will be removed in v5 of Transformers. You can tokenize your labels by using the argument `text_target` of the regular `__call__` method (either in the same call as your input texts if you use the same keyword arguments, or in a separate call.
  warnings.warn(
[02.03 18:15:37] ┇ INFO    ┇                 DeepKNLP ┇ Loaded raw eval_dataset (#=100): data/gner/each-sampled/crossner_ai-dev=100.jsonl
[02.03 18:15:37] ┇ INFO    ┇                 DeepKNLP ┇ Completed preprocessing for eval_dataset at [02.03 17:35:21]
[02.03 18:15:52] ┇ WARNING ┇                DeepSpeed ┇ Attempting to get learning rate from scheduler before it has started
[02.03 18:15:52] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.03 18:15:52] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ ***** Beginning Training *****
[02.03 18:15:52] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Train Epochs       = 1.0
[02.03 18:15:52] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Train Examples     = 100
[02.03 18:15:52] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Train Batch Size   = 4 = 1 * 1 * 4
[02.03 18:15:52] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Train Optim Steps  = 25 = 25 * 1.0
[02.03 18:15:52] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Train Model Params = 783,150,080
[02.03 18:15:52] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Trainer Callbacks  = DefaultFlowCallback, CustomProgressCallback
[02.03 18:15:52] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Zero Optim Stage   = 2
[02.03 18:15:52] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Eval Examples      = 100
[02.03 18:15:52] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Eval Batch Size    = 100 = 25 * 4
[02.03 18:15:52] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]   4%|▊                   |  1/25 [0:00:00<0:00:14, 1.61Hz] | epoch=0.04, loss=1.065400
[02.03 18:15:54] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]   8%|█▌                  |  2/25 [0:00:01<0:00:19, 1.18Hz] | epoch=0.08, loss=1.047900
[02.03 18:15:54] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  12%|██▍                 |  3/25 [0:00:02<0:00:15, 1.41Hz] | epoch=0.12, loss=1.197300
[02.03 18:15:54] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  16%|███▏                |  4/25 [0:00:02<0:00:13, 1.56Hz] | epoch=0.16, loss=0.854500
[02.03 18:15:55] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  20%|████                |  5/25 [0:00:03<0:00:14, 1.38Hz] | epoch=0.20, loss=0.806600
[02.03 18:15:56] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  24%|████▊               |  6/25 [0:00:04<0:00:12, 1.48Hz] | epoch=0.24, loss=1.113300
[02.03 18:15:56] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  28%|█████▌              |  7/25 [0:00:04<0:00:11, 1.56Hz] | epoch=0.28, loss=0.625500
[02.03 18:15:57] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  32%|██████▍             |  8/25 [0:00:05<0:00:11, 1.53Hz] | epoch=0.32, loss=0.596700
[02.03 18:15:58] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  36%|███████▏            |  9/25 [0:00:05<0:00:10, 1.59Hz] | epoch=0.36, loss=0.523900
[02.03 18:15:58] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  40%|████████            | 10/25 [0:00:06<0:00:09, 1.63Hz] | epoch=0.40, loss=0.692400
[02.03 18:15:58] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  44%|████████▊           | 11/25 [0:00:06<0:00:08, 1.67Hz] | epoch=0.44, loss=0.496600
[02.03 18:16:00] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  48%|█████████▌          | 12/25 [0:00:07<0:00:08, 1.57Hz] | epoch=0.48, loss=0.543000
[02.03 18:16:00] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  52%|██████████▍         | 13/25 [0:00:08<0:00:07, 1.61Hz] | epoch=0.52, loss=0.519000
[02.03 18:16:00] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  56%|███████████▏        | 14/25 [0:00:08<0:00:06, 1.64Hz] | epoch=0.56, loss=0.428500
[02.03 18:16:01] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  60%|████████████        | 15/25 [0:00:08<0:00:05, 1.67Hz] | epoch=0.60, loss=0.369100
[02.03 18:16:01] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  64%|████████████▊       | 16/25 [0:00:09<0:00:05, 1.69Hz] | epoch=0.64, loss=0.626000
[02.03 18:16:02] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  68%|█████████████▌      | 17/25 [0:00:09<0:00:04, 1.72Hz] | epoch=0.68, loss=0.383300
[02.03 18:16:02] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  72%|██████████████▍     | 18/25 [0:00:10<0:00:04, 1.74Hz] | epoch=0.72, loss=0.406000
[02.03 18:16:03] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  76%|███████████████▏    | 19/25 [0:00:10<0:00:03, 1.76Hz] | epoch=0.76, loss=0.385300
[02.03 18:16:03] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  80%|████████████████    | 20/25 [0:00:11<0:00:02, 1.79Hz] | epoch=0.80, loss=0.449200
[02.03 18:16:04] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  84%|████████████████▊   | 21/25 [0:00:12<0:00:02, 1.74Hz] | epoch=0.84, loss=0.329100
[02.03 18:16:04] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  88%|█████████████████▌  | 22/25 [0:00:12<0:00:01, 1.76Hz] | epoch=0.88, loss=0.408400
[02.03 18:16:05] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  92%|██████████████████▍ | 23/25 [0:00:12<0:00:01, 1.78Hz] | epoch=0.92, loss=0.407700
[02.03 18:16:05] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training]  96%|███████████████████▏| 24/25 [0:00:13<0:00:00, 1.80Hz] | epoch=0.96, loss=0.372100
[02.03 18:16:06] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training] 100%|████████████████████| 25/25 [0:00:13<0:00:00, 1.81Hz] | epoch=1.00, loss=0.404300
[02.03 18:16:06] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ [training] 100%|████████████████████| 25/25 [0:00:13<0:00:00, 1.81Hz] | epoch=1.00, train_loss=0.6020, total_pflos=0.100
[02.03 18:16:06] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.03 18:16:06] ┇ INFO    ┇                 DeepKNLP ┇ Train output metrics: {'train_runtime': 13.8538, 'train_samples_per_second': 7.218, 'train_steps_per_second': 1.805, 'total_flos': 99676713123840.0, 'train_loss': 0.602041015625, 'epoch': 1.0}
[02.03 18:16:06] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.03 18:16:06] ┇ INFO    ┇           chrisbase.data ┇ [EXIT] python task2-nerG-trainer.py --local_rank=0 data/gner/each/crossner_ai-train.jsonl --eval_file data/gner/each-sampled/crossner_ai-dev=100.jsonl --pretrained google/flan-t5-large --run_version FLAN-T5-Large --per_device_train_batch_size 1 --trainer_deepspeed configs/deepspeed/ds2_llama.json ($=00:00:31.779)
[02.03 18:16:06] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[2025-02-03 18:16:09,287] [INFO] [launch.py:351:main] Process 419139 exits successfully.
[2025-02-03 18:16:09,287] [INFO] [launch.py:351:main] Process 419141 exits successfully.
[2025-02-03 18:16:09,287] [INFO] [launch.py:351:main] Process 419142 exits successfully.
[2025-02-03 18:16:09,288] [INFO] [launch.py:351:main] Process 419140 exits successfully.
+ python -m deepspeed.launcher.runner --include=localhost:0,1,2,3 --master_port 25598 task2-nerG-trainer.py data/gner/each/crossner_ai-train.jsonl --eval_file data/gner/each-sampled/crossner_ai-dev=100.jsonl --pretrained meta-llama/Llama-3.2-1B --run_version Llama-3-1B --per_device_train_batch_size 1 --trainer_deepspeed configs/deepspeed/ds2_llama.json
[2025-02-03 18:16:14,538] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:16:18,374] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-02-03 18:16:18,374] [INFO] [runner.py:607:main] cmd = /home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgM119 --master_addr=127.0.0.1 --master_port=25598 --enable_each_rank_log=None task2-nerG-trainer.py data/gner/each/crossner_ai-train.jsonl --eval_file data/gner/each-sampled/crossner_ai-dev=100.jsonl --pretrained meta-llama/Llama-3.2-1B --run_version Llama-3-1B --per_device_train_batch_size 1 --trainer_deepspeed configs/deepspeed/ds2_llama.json
[2025-02-03 18:16:20,380] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:16:23,299] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3]}
[2025-02-03 18:16:23,299] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=4, node_rank=0
[2025-02-03 18:16:23,299] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2025-02-03 18:16:23,299] [INFO] [launch.py:164:main] dist_world_size=4
[2025-02-03 18:16:23,299] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
[2025-02-03 18:16:23,300] [INFO] [launch.py:256:main] process 420065 spawned with command: ['/home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python', '-u', 'task2-nerG-trainer.py', '--local_rank=0', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'meta-llama/Llama-3.2-1B', '--run_version', 'Llama-3-1B', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json']
[2025-02-03 18:16:23,301] [INFO] [launch.py:256:main] process 420066 spawned with command: ['/home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python', '-u', 'task2-nerG-trainer.py', '--local_rank=1', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'meta-llama/Llama-3.2-1B', '--run_version', 'Llama-3-1B', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json']
[2025-02-03 18:16:23,301] [INFO] [launch.py:256:main] process 420067 spawned with command: ['/home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python', '-u', 'task2-nerG-trainer.py', '--local_rank=2', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'meta-llama/Llama-3.2-1B', '--run_version', 'Llama-3-1B', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json']
[2025-02-03 18:16:23,302] [INFO] [launch.py:256:main] process 420068 spawned with command: ['/home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python', '-u', 'task2-nerG-trainer.py', '--local_rank=3', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'meta-llama/Llama-3.2-1B', '--run_version', 'Llama-3-1B', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json']
[2025-02-03 18:16:31,255] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:16:31,256] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:16:31,258] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:16:31,261] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:16:31,976] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-03 18:16:31,978] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-03 18:16:31,980] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-03 18:16:31,980] [INFO] [comm.py:652:init_distributed] cdb=None
[02.03 18:16:32] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.03 18:16:32] ┇ INFO    ┇           chrisbase.data ┇ [INIT] python task2-nerG-trainer.py --local_rank=0 data/gner/each/crossner_ai-train.jsonl --eval_file data/gner/each-sampled/crossner_ai-dev=100.jsonl --pretrained meta-llama/Llama-3.2-1B --run_version Llama-3-1B --per_device_train_batch_size 1 --trainer_deepspeed configs/deepspeed/ds2_llama.json
[02.03 18:16:32] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇   #     TrainingArgumentsForAccelerator                 value
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇   1     env.hostname                                    ptlm3
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇   2     env.hostaddr                                    129.254.121.74
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇   3     env.global_rank                                 -1
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇   4     env.local_rank                                  0
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇   5     env.node_rank                                   -1
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇   6     env.world_size                                  4
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇   7     env.time_stamp                                  0203-181628
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇   8     env.python_path                                 /home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇   9     env.current_dir                                 /home/chrisjihee/proj/DeepKNLP
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  10     env.current_file                                task2-nerG-trainer.py
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  11     env.command_args                                ['--local_rank=0', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'meta-llama/Llama-3.2-1B', '--run_version', 'Llama-3-1B', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json']
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  12     env.output_home                                 output
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  13     env.output_name                                 GNER
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  14     env.run_version                                 Llama-3-1B
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  15     env.output_file                                 train-metrics-0203-181628.csv
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  16     env.logging_file                                train-loggings-0203-181628.out
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  17     env.logging_level                               30
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  18     env.logging_format                              %(asctime)s ┇ %(levelname)-7s ┇ %(name)24s ┇ %(message)s
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  19     env.datetime_format                             [%m.%d %H:%M:%S]
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  20     env.argument_file                               train-arguments-0203-181628.json
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  21     env.random_seed                                 7
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  22     env.max_workers                                 4
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  23     env.debugging                                   False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  24     env.output_dir                                  output/GNER/Llama-3-1B
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  25     time.t1                                         2025-02-03 18:16:33.005640
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  26     time.t2                                         2025-02-03 18:16:27.064441
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  27     time.started                                    [02.03 18:16:33]
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  28     time.settled
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  29     time.elapsed
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  30     data.train_file                                 data/gner/each/crossner_ai-train.jsonl
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  31     data.study_file
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  32     data.eval_file                                  data/gner/each-sampled/crossner_ai-dev=100.jsonl
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  33     data.pred_file
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  34     data.pretrained                                 meta-llama/Llama-3.2-1B
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  35     data.max_train_samples                          -1
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  36     data.max_study_samples                          -1
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  37     data.max_eval_samples                           -1
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  38     data.max_pred_samples                           -1
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  39     data.use_cache_data                             True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  40     data.progress_seconds                           10.0
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  41     data.max_source_length                          640
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  42     data.max_target_length                          640
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  43     data.write_predictions                          False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  44     data.ignore_pad_token_for_loss                  True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  45     train._n_gpu                                    1
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  46     train.accelerator_config                        {'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'non_blocking': False, 'gradient_accumulation_kwargs': None, 'use_configured_state': False}
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  47     train.adafactor                                 False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  48     train.adam_beta1                                0.9
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  49     train.adam_beta2                                0.999
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  50     train.adam_epsilon                              1e-08
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  51     train.auto_find_batch_size                      False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  52     train.average_tokens_across_devices             False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  53     train.batch_eval_metrics                        False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  54     train.bf16                                      True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  55     train.bf16_full_eval                            True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  56     train.data_seed
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  57     train.dataloader_drop_last                      False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  58     train.dataloader_num_workers                    0
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  59     train.dataloader_persistent_workers             False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  60     train.dataloader_pin_memory                     True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  61     train.dataloader_prefetch_factor
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  62     train.ddp_backend
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  63     train.ddp_broadcast_buffers
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  64     train.ddp_bucket_cap_mb
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  65     train.ddp_find_unused_parameters
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  66     train.ddp_timeout                               1800
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  67     train.debug                                     []
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  68     train.deepspeed                                 configs/deepspeed/ds2_llama.json
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  69     train.disable_tqdm                              True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  70     train.dispatch_batches
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  71     train.do_eval                                   True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  72     train.do_predict                                False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  73     train.do_train                                  True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  74     train.eval_accumulation_steps                   1
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  75     train.eval_delay                                1.0
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  76     train.eval_do_concat_batches                    True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  77     train.eval_epochs                               -1.0
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  78     train.eval_on_start                             False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  79     train.eval_steps                                9223372036854775807
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  80     train.eval_strategy                             IntervalStrategy.NO
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  81     train.eval_use_gather_object                    False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  82     train.evaluation_strategy
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  83     train.fp16                                      False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  84     train.fp16_backend                              auto
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  85     train.fp16_full_eval                            False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  86     train.fp16_opt_level                            O1
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  87     train.fsdp                                      []
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  88     train.fsdp_config                               {'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False}
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  89     train.fsdp_min_num_params                       0
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  90     train.fsdp_transformer_layer_cls_to_wrap
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  91     train.full_determinism                          False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  92     train.generation_config
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  93     train.generation_max_length                     640
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  94     train.generation_num_beams
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  95     train.gradient_accumulation_steps               1
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  96     train.gradient_checkpointing                    True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  97     train.gradient_checkpointing_kwargs
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  98     train.greater_is_better
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇  99     train.group_by_length                           False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 100     train.half_precision_backend                    auto
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 101     train.hub_always_push                           False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 102     train.hub_model_id
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 103     train.hub_private_repo
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 104     train.hub_strategy                              HubStrategy.EVERY_SAVE
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 105     train.hub_token
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 106     train.ignore_data_skip                          False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 107     train.include_for_metrics                       []
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 108     train.include_inputs_for_metrics                False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 109     train.include_num_input_tokens_seen             False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 110     train.include_tokens_per_second                 False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 111     train.jit_mode_eval                             False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 112     train.label_names
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 113     train.label_smoothing_factor                    0.0
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 114     train.learning_rate                             2e-05
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 115     train.length_column_name                        length
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 116     train.load_best_model_at_end                    False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 117     train.local_rank                                0
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 118     train.log_level                                 warning
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 119     train.log_level_replica                         error
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 120     train.log_on_each_node                          True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 121     train.logging_dir                               output/GNER/Llama-3-1B/runs/Feb03_18-16-31_ptlm3
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 122     train.logging_epochs                            -1.0
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 123     train.logging_first_step                        False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 124     train.logging_nan_inf_filter                    True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 125     train.logging_steps                             1
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 126     train.logging_strategy                          IntervalStrategy.STEPS
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 127     train.lr_scheduler_kwargs                       {}
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 128     train.lr_scheduler_type                         SchedulerType.COSINE
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 129     train.max_grad_norm                             1.0
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 130     train.max_steps                                 -1
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 131     train.metric_for_best_model
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 132     train.mp_parameters
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 133     train.neftune_noise_alpha
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 134     train.no_cuda                                   False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 135     train.num_train_epochs                          1.0
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 136     train.optim                                     OptimizerNames.ADAMW_TORCH
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 137     train.optim_args
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 138     train.optim_target_modules
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 139     train.output_dir                                output/GNER/Llama-3-1B
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 140     train.overwrite_output_dir                      True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 141     train.past_index                                -1
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 142     train.per_device_eval_batch_size                25
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 143     train.per_device_train_batch_size               1
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 144     train.per_gpu_eval_batch_size
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 145     train.per_gpu_train_batch_size
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 146     train.predict_with_generate                     True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 147     train.prediction_loss_only                      False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 148     train.push_to_hub                               False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 149     train.push_to_hub_model_id
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 150     train.push_to_hub_organization
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 151     train.push_to_hub_token
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 152     train.ray_scope                                 last
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 153     train.remove_unused_columns                     False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 154     train.report_to                                 []
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 155     train.restore_callback_states_from_checkpoint   False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 156     train.resume_from_checkpoint
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 157     train.run_name                                  output/GNER/Llama-3-1B
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 158     train.save_epochs                               -1.0
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 159     train.save_on_each_node                         False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 160     train.save_only_model                           False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 161     train.save_safetensors                          True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 162     train.save_steps                                9223372036854775807
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 163     train.save_strategy                             SaveStrategy.NO
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 164     train.save_total_limit
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 165     train.seed                                      7
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 166     train.skip_memory_metrics                       True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 167     train.sortish_sampler                           False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 168     train.split_batches
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 169     train.tf32                                      True
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 170     train.torch_compile                             False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 171     train.torch_compile_backend
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 172     train.torch_compile_mode
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 173     train.torch_empty_cache_steps
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 174     train.torchdynamo
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 175     train.tpu_metrics_debug                         False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 176     train.tpu_num_cores
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 177     train.use_cpu                                   False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 178     train.use_ipex                                  False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 179     train.use_legacy_prediction_loop                False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 180     train.use_liger_kernel                          False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 181     train.use_mps_device                            False
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 182     train.warmup_ratio                              0.04
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 183     train.warmup_steps                              0
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ 184     train.weight_decay                              0.0
[02.03 18:16:33] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.03 18:16:36] ┇ INFO    ┇                 DeepKNLP ┇ type(model)=<class 'transformers.models.llama.modeling_llama.LlamaForCausalLM'>
[02.03 18:16:36] ┇ INFO    ┇                 DeepKNLP ┇ model.generation_config.pad_token_id=128001
[02.03 18:16:37] ┇ INFO    ┇                 DeepKNLP ┇ Loaded raw train_dataset (#=100): data/gner/each/crossner_ai-train.jsonl
[02.03 18:16:37] ┇ INFO    ┇                 DeepKNLP ┇ Completed preprocessing for train_dataset at [02.03 18:15:36]
[02.03 18:16:37] ┇ INFO    ┇                 DeepKNLP ┇ Loaded raw eval_dataset (#=100): data/gner/each-sampled/crossner_ai-dev=100.jsonl
[02.03 18:16:38] ┇ INFO    ┇                 DeepKNLP ┇ Completed preprocessing for eval_dataset at [02.03 17:35:21]
[02.03 18:16:47] ┇ WARNING ┇                DeepSpeed ┇ Attempting to get learning rate from scheduler before it has started
[02.03 18:16:47] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.03 18:16:47] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ ***** Beginning Training *****
[02.03 18:16:47] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Train Epochs       = 1.0
[02.03 18:16:47] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Train Examples     = 100
[02.03 18:16:47] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Train Batch Size   = 4 = 1 * 1 * 4
[02.03 18:16:47] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Train Optim Steps  = 25 = 25 * 1.0
[02.03 18:16:47] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Train Model Params = 1,235,814,400
[02.03 18:16:47] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Trainer Callbacks  = DefaultFlowCallback, CustomProgressCallback
[02.03 18:16:47] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Zero Optim Stage   = 2
[02.03 18:16:47] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Eval Examples      = 100
[02.03 18:16:47] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Eval Batch Size    = 100 = 25 * 4
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/task2-nerG-trainer.py", line 703, in <module>
[rank0]:     AppTyper.run(main)
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/chrisbase/src/chrisbase/data.py", line 48, in run
[rank0]:     app()
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank0]:     raise e
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank0]:     return get_command(self)(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank0]:     return self.main(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank0]:     return _main(
[rank0]:            ^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank0]:     rv = self.invoke(ctx)
[rank0]:          ^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank0]:     return ctx.invoke(self.callback, **ctx.params)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank0]:     return __callback(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank0]:     return callback(**use_params)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/task2-nerG-trainer.py", line 695, in main
[rank0]:     train_result: TrainOutput = trainer.train()
[rank0]:                                 ^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/trainer.py", line 2184, in train
[rank0]:     return inner_training_loop(
[rank0]:            ^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/trainer.py", line 2490, in _inner_training_loop
[rank0]:     tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
[rank0]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/trainer.py", line 3598, in training_step
[rank0]:     loss = self.compute_loss(model, inputs, num_items_in_batch=num_items_in_batch)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/trainer.py", line 3659, in compute_loss
[rank0]:     outputs = model(**inputs)
[rank0]:               ^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/deepspeed/utils/nvtx.py", line 18, in wrapped_fn
[rank0]:     ret_val = func(*args, **kwargs)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 1914, in forward
[rank0]:     loss = self.module(*inputs, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/utils/deprecation.py", line 172, in wrapped_func
[rank0]:     return func(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/models/llama/modeling_llama.py", line 860, in forward
[rank0]:     loss = self.loss_function(logits=logits, labels=labels, vocab_size=self.config.vocab_size, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/loss/loss_utils.py", line 47, in ForCausalLMLoss
[rank0]:     loss = fixed_cross_entropy(logits, shift_labels, num_items_in_batch, ignore_index, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/loss/loss_utils.py", line 26, in fixed_cross_entropy
[rank0]:     loss = nn.functional.cross_entropy(source, target, ignore_index=ignore_index, reduction=reduction)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
[rank0]:     return torch._C._nn.cross_entropy_loss(
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: ValueError: Expected input batch_size (246) to match target batch_size (290).



[2025-02-03 18:16:49,306] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 420065
[2025-02-03 18:16:49,380] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 420066
[2025-02-03 18:16:49,402] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 420067
[2025-02-03 18:16:49,424] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 420068
[2025-02-03 18:16:49,424] [ERROR] [launch.py:325:sigkill_handler] ['/home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python', '-u', 'task2-nerG-trainer.py', '--local_rank=3', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'meta-llama/Llama-3.2-1B', '--run_version', 'Llama-3-1B', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json'] exits with return code = 1
+ python -m deepspeed.launcher.runner --include=localhost:0,1,2,3 --master_port 25598 task2-nerG-trainer.py data/gner/each/crossner_ai-train.jsonl --eval_file data/gner/each-sampled/crossner_ai-dev=100.jsonl --pretrained etri-lirs/egpt-1.3b-preview --run_version EAGLE-1B-supervised --per_device_train_batch_size 1 --trainer_deepspeed configs/deepspeed/ds2_llama.json
[2025-02-03 18:16:53,162] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:16:56,674] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-02-03 18:16:56,674] [INFO] [runner.py:607:main] cmd = /home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgM119 --master_addr=127.0.0.1 --master_port=25598 --enable_each_rank_log=None task2-nerG-trainer.py data/gner/each/crossner_ai-train.jsonl --eval_file data/gner/each-sampled/crossner_ai-dev=100.jsonl --pretrained etri-lirs/egpt-1.3b-preview --run_version EAGLE-1B-supervised --per_device_train_batch_size 1 --trainer_deepspeed configs/deepspeed/ds2_llama.json
[2025-02-03 18:16:58,964] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:17:01,861] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3]}
[2025-02-03 18:17:01,861] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=4, node_rank=0
[2025-02-03 18:17:01,861] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2025-02-03 18:17:01,861] [INFO] [launch.py:164:main] dist_world_size=4
[2025-02-03 18:17:01,861] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
[2025-02-03 18:17:01,862] [INFO] [launch.py:256:main] process 420839 spawned with command: ['/home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python', '-u', 'task2-nerG-trainer.py', '--local_rank=0', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'etri-lirs/egpt-1.3b-preview', '--run_version', 'EAGLE-1B-supervised', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json']
[2025-02-03 18:17:01,863] [INFO] [launch.py:256:main] process 420840 spawned with command: ['/home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python', '-u', 'task2-nerG-trainer.py', '--local_rank=1', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'etri-lirs/egpt-1.3b-preview', '--run_version', 'EAGLE-1B-supervised', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json']
[2025-02-03 18:17:01,863] [INFO] [launch.py:256:main] process 420841 spawned with command: ['/home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python', '-u', 'task2-nerG-trainer.py', '--local_rank=2', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'etri-lirs/egpt-1.3b-preview', '--run_version', 'EAGLE-1B-supervised', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json']
[2025-02-03 18:17:01,864] [INFO] [launch.py:256:main] process 420842 spawned with command: ['/home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python', '-u', 'task2-nerG-trainer.py', '--local_rank=3', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'etri-lirs/egpt-1.3b-preview', '--run_version', 'EAGLE-1B-supervised', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json']
[2025-02-03 18:17:11,306] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:17:11,315] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:17:11,315] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:17:11,316] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-03 18:17:12,014] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-03 18:17:12,015] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-03 18:17:12,026] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-03 18:17:12,029] [INFO] [comm.py:652:init_distributed] cdb=None
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ [INIT] python task2-nerG-trainer.py --local_rank=0 data/gner/each/crossner_ai-train.jsonl --eval_file data/gner/each-sampled/crossner_ai-dev=100.jsonl --pretrained etri-lirs/egpt-1.3b-preview --run_version EAGLE-1B-supervised --per_device_train_batch_size 1 --trainer_deepspeed configs/deepspeed/ds2_llama.json
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇   #     TrainingArgumentsForAccelerator                 value
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇   1     env.hostname                                    ptlm3
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇   2     env.hostaddr                                    129.254.121.74
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇   3     env.global_rank                                 -1
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇   4     env.local_rank                                  0
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇   5     env.node_rank                                   -1
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇   6     env.world_size                                  4
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇   7     env.time_stamp                                  0203-181707
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇   8     env.python_path                                 /home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇   9     env.current_dir                                 /home/chrisjihee/proj/DeepKNLP
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  10     env.current_file                                task2-nerG-trainer.py
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  11     env.command_args                                ['--local_rank=0', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'etri-lirs/egpt-1.3b-preview', '--run_version', 'EAGLE-1B-supervised', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json']
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  12     env.output_home                                 output
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  13     env.output_name                                 GNER
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  14     env.run_version                                 EAGLE-1B-supervised
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  15     env.output_file                                 train-metrics-0203-181707.csv
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  16     env.logging_file                                train-loggings-0203-181707.out
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  17     env.logging_level                               30
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  18     env.logging_format                              %(asctime)s ┇ %(levelname)-7s ┇ %(name)24s ┇ %(message)s
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  19     env.datetime_format                             [%m.%d %H:%M:%S]
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  20     env.argument_file                               train-arguments-0203-181707.json
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  21     env.random_seed                                 7
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  22     env.max_workers                                 4
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  23     env.debugging                                   False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  24     env.output_dir                                  output/GNER/EAGLE-1B-supervised
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  25     time.t1                                         2025-02-03 18:17:12.662099
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  26     time.t2                                         2025-02-03 18:17:06.115767
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  27     time.started                                    [02.03 18:17:12]
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  28     time.settled
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  29     time.elapsed
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  30     data.train_file                                 data/gner/each/crossner_ai-train.jsonl
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  31     data.study_file
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  32     data.eval_file                                  data/gner/each-sampled/crossner_ai-dev=100.jsonl
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  33     data.pred_file
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  34     data.pretrained                                 etri-lirs/egpt-1.3b-preview
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  35     data.max_train_samples                          -1
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  36     data.max_study_samples                          -1
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  37     data.max_eval_samples                           -1
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  38     data.max_pred_samples                           -1
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  39     data.use_cache_data                             True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  40     data.progress_seconds                           10.0
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  41     data.max_source_length                          640
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  42     data.max_target_length                          640
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  43     data.write_predictions                          False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  44     data.ignore_pad_token_for_loss                  True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  45     train._n_gpu                                    1
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  46     train.accelerator_config                        {'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'non_blocking': False, 'gradient_accumulation_kwargs': None, 'use_configured_state': False}
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  47     train.adafactor                                 False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  48     train.adam_beta1                                0.9
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  49     train.adam_beta2                                0.999
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  50     train.adam_epsilon                              1e-08
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  51     train.auto_find_batch_size                      False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  52     train.average_tokens_across_devices             False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  53     train.batch_eval_metrics                        False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  54     train.bf16                                      True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  55     train.bf16_full_eval                            True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  56     train.data_seed
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  57     train.dataloader_drop_last                      False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  58     train.dataloader_num_workers                    0
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  59     train.dataloader_persistent_workers             False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  60     train.dataloader_pin_memory                     True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  61     train.dataloader_prefetch_factor
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  62     train.ddp_backend
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  63     train.ddp_broadcast_buffers
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  64     train.ddp_bucket_cap_mb
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  65     train.ddp_find_unused_parameters
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  66     train.ddp_timeout                               1800
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  67     train.debug                                     []
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  68     train.deepspeed                                 configs/deepspeed/ds2_llama.json
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  69     train.disable_tqdm                              True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  70     train.dispatch_batches
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  71     train.do_eval                                   True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  72     train.do_predict                                False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  73     train.do_train                                  True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  74     train.eval_accumulation_steps                   1
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  75     train.eval_delay                                1.0
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  76     train.eval_do_concat_batches                    True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  77     train.eval_epochs                               -1.0
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  78     train.eval_on_start                             False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  79     train.eval_steps                                9223372036854775807
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  80     train.eval_strategy                             IntervalStrategy.NO
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  81     train.eval_use_gather_object                    False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  82     train.evaluation_strategy
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  83     train.fp16                                      False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  84     train.fp16_backend                              auto
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  85     train.fp16_full_eval                            False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  86     train.fp16_opt_level                            O1
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  87     train.fsdp                                      []
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  88     train.fsdp_config                               {'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False}
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  89     train.fsdp_min_num_params                       0
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  90     train.fsdp_transformer_layer_cls_to_wrap
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  91     train.full_determinism                          False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  92     train.generation_config
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  93     train.generation_max_length                     640
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  94     train.generation_num_beams
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  95     train.gradient_accumulation_steps               1
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  96     train.gradient_checkpointing                    True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  97     train.gradient_checkpointing_kwargs
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  98     train.greater_is_better
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇  99     train.group_by_length                           False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 100     train.half_precision_backend                    auto
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 101     train.hub_always_push                           False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 102     train.hub_model_id
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 103     train.hub_private_repo
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 104     train.hub_strategy                              HubStrategy.EVERY_SAVE
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 105     train.hub_token
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 106     train.ignore_data_skip                          False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 107     train.include_for_metrics                       []
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 108     train.include_inputs_for_metrics                False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 109     train.include_num_input_tokens_seen             False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 110     train.include_tokens_per_second                 False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 111     train.jit_mode_eval                             False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 112     train.label_names
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 113     train.label_smoothing_factor                    0.0
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 114     train.learning_rate                             2e-05
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 115     train.length_column_name                        length
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 116     train.load_best_model_at_end                    False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 117     train.local_rank                                0
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 118     train.log_level                                 warning
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 119     train.log_level_replica                         error
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 120     train.log_on_each_node                          True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 121     train.logging_dir                               output/GNER/EAGLE-1B-supervised/runs/Feb03_18-17-11_ptlm3
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 122     train.logging_epochs                            -1.0
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 123     train.logging_first_step                        False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 124     train.logging_nan_inf_filter                    True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 125     train.logging_steps                             1
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 126     train.logging_strategy                          IntervalStrategy.STEPS
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 127     train.lr_scheduler_kwargs                       {}
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 128     train.lr_scheduler_type                         SchedulerType.COSINE
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 129     train.max_grad_norm                             1.0
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 130     train.max_steps                                 -1
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 131     train.metric_for_best_model
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 132     train.mp_parameters
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 133     train.neftune_noise_alpha
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 134     train.no_cuda                                   False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 135     train.num_train_epochs                          1.0
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 136     train.optim                                     OptimizerNames.ADAMW_TORCH
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 137     train.optim_args
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 138     train.optim_target_modules
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 139     train.output_dir                                output/GNER/EAGLE-1B-supervised
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 140     train.overwrite_output_dir                      True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 141     train.past_index                                -1
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 142     train.per_device_eval_batch_size                25
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 143     train.per_device_train_batch_size               1
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 144     train.per_gpu_eval_batch_size
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 145     train.per_gpu_train_batch_size
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 146     train.predict_with_generate                     True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 147     train.prediction_loss_only                      False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 148     train.push_to_hub                               False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 149     train.push_to_hub_model_id
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 150     train.push_to_hub_organization
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 151     train.push_to_hub_token
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 152     train.ray_scope                                 last
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 153     train.remove_unused_columns                     False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 154     train.report_to                                 []
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 155     train.restore_callback_states_from_checkpoint   False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 156     train.resume_from_checkpoint
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 157     train.run_name                                  output/GNER/EAGLE-1B-supervised
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 158     train.save_epochs                               -1.0
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 159     train.save_on_each_node                         False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 160     train.save_only_model                           False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 161     train.save_safetensors                          True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 162     train.save_steps                                9223372036854775807
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 163     train.save_strategy                             SaveStrategy.NO
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 164     train.save_total_limit
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 165     train.seed                                      7
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 166     train.skip_memory_metrics                       True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 167     train.sortish_sampler                           False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 168     train.split_batches
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 169     train.tf32                                      True
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 170     train.torch_compile                             False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 171     train.torch_compile_backend
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 172     train.torch_compile_mode
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 173     train.torch_empty_cache_steps
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 174     train.torchdynamo
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 175     train.tpu_metrics_debug                         False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 176     train.tpu_num_cores
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 177     train.use_cpu                                   False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 178     train.use_ipex                                  False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 179     train.use_legacy_prediction_loop                False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 180     train.use_liger_kernel                          False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 181     train.use_mps_device                            False
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 182     train.warmup_ratio                              0.04
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 183     train.warmup_steps                              0
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ 184     train.weight_decay                              0.0
[02.03 18:17:12] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.03 18:17:17] ┇ INFO    ┇                 DeepKNLP ┇ type(model)=<class 'transformers.models.gpt_neox.modeling_gpt_neox.GPTNeoXForCausalLM'>
[02.03 18:17:17] ┇ INFO    ┇                 DeepKNLP ┇ model.generation_config.pad_token_id=0
[02.03 18:17:17] ┇ INFO    ┇                 DeepKNLP ┇ Loaded raw train_dataset (#=100): data/gner/each/crossner_ai-train.jsonl
[02.03 18:17:17] ┇ INFO    ┇                 DeepKNLP ┇ Completed preprocessing for train_dataset at [02.03 18:15:36]
[02.03 18:17:18] ┇ INFO    ┇                 DeepKNLP ┇ Loaded raw eval_dataset (#=100): data/gner/each-sampled/crossner_ai-dev=100.jsonl
[02.03 18:17:18] ┇ INFO    ┇                 DeepKNLP ┇ Completed preprocessing for eval_dataset at [02.03 17:35:21]
[02.03 18:17:27] ┇ WARNING ┇                DeepSpeed ┇ Attempting to get learning rate from scheduler before it has started
[02.03 18:17:27] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.03 18:17:27] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ ***** Beginning Training *****
[02.03 18:17:27] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Train Epochs       = 1.0
[02.03 18:17:27] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Train Examples     = 100
[02.03 18:17:27] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Train Batch Size   = 4 = 1 * 1 * 4
[02.03 18:17:27] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Train Optim Steps  = 25 = 25 * 1.0
[02.03 18:17:27] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Train Model Params = 1,341,247,488
[02.03 18:17:27] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Trainer Callbacks  = DefaultFlowCallback, CustomProgressCallback
[02.03 18:17:27] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Zero Optim Stage   = 2
[02.03 18:17:27] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Eval Examples      = 100
[02.03 18:17:27] ┇ INFO    ┇    DeepKNLP.gner.trainer ┇ >> Eval Batch Size    = 100 = 25 * 4
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/task2-nerG-trainer.py", line 703, in <module>
[rank0]:     AppTyper.run(main)
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/chrisbase/src/chrisbase/data.py", line 48, in run
[rank0]:     app()
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank0]:     raise e
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank0]:     return get_command(self)(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank0]:     return self.main(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank0]:     return _main(
[rank0]:            ^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank0]:     rv = self.invoke(ctx)
[rank0]:          ^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank0]:     return ctx.invoke(self.callback, **ctx.params)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank0]:     return __callback(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank0]:     return callback(**use_params)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/task2-nerG-trainer.py", line 695, in main
[rank0]:     train_result: TrainOutput = trainer.train()
[rank0]:                                 ^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/trainer.py", line 2184, in train
[rank0]:     return inner_training_loop(
[rank0]:            ^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/trainer.py", line 2490, in _inner_training_loop
[rank0]:     tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
[rank0]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/trainer.py", line 3598, in training_step
[rank0]:     loss = self.compute_loss(model, inputs, num_items_in_batch=num_items_in_batch)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/trainer.py", line 3659, in compute_loss
[rank0]:     outputs = model(**inputs)
[rank0]:               ^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/deepspeed/utils/nvtx.py", line 18, in wrapped_fn
[rank0]:     ret_val = func(*args, **kwargs)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 1914, in forward
[rank0]:     loss = self.module(*inputs, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/proj/DeepKNLP/transformers/src/transformers/models/gpt_neox/modeling_gpt_neox.py", line 1109, in forward
[rank0]:     lm_loss = loss_fct(shift_logits.view(-1, shift_logits.size(-1)), labels.view(-1))
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
[rank0]:     return F.cross_entropy(
[rank0]:            ^^^^^^^^^^^^^^^^
[rank0]:   File "/home/chrisjihee/miniforge3/envs/DeepKNLP/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
[rank0]:     return torch._C._nn.cross_entropy_loss(
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: ValueError: Expected input batch_size (245) to match target batch_size (289).
[2025-02-03 18:17:28,868] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 420839
[2025-02-03 18:17:29,184] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 420840
[2025-02-03 18:17:29,195] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 420841
[2025-02-03 18:17:29,195] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 420842
[2025-02-03 18:17:29,205] [ERROR] [launch.py:325:sigkill_handler] ['/home/chrisjihee/miniforge3/envs/DeepKNLP/bin/python', '-u', 'task2-nerG-trainer.py', '--local_rank=3', 'data/gner/each/crossner_ai-train.jsonl', '--eval_file', 'data/gner/each-sampled/crossner_ai-dev=100.jsonl', '--pretrained', 'etri-lirs/egpt-1.3b-preview', '--run_version', 'EAGLE-1B-supervised', '--per_device_train_batch_size', '1', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json'] exits with return code = 1
